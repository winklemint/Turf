{{template "header.html"}}

<div class="card-box pb-10">
    <!-- Export Datatable start -->
    <div class="card-box mb-30">
        <div class="pd-20">
            <!-- <h4 class="text-blue h4">Data Table with Export Buttons</h4> -->
        </div>
        <div class="pb-20">
            <table class="table hover multiple-select-row data-table-export nowrap" id="all_confirmed_bookings_tbl">
                <thead>
                    <tr>
                        <th>Sn.</th>
 						<th>Name</th>
						<th>Date</th>
						<th>Total Price</th>
						<th>Total Min Amount To Pay</th>
						<th>Paid Amount</th>
						<th>Remaining Amount To Pay</th>
						<th>Booking Status</th>
						<th>Branch Id</th>
						
                    </tr>
                </thead>
                <tbody>
                </tbody>
            </table>
        </div>
    </div>
    <!-- Export Datatable End -->

    {{template "footer.html"}}
    <script>
        $(document).ready(function () {
            // Initialize DataTable
            var table = $('#all_confirmed_bookings_tbl').DataTable();
            // Make an AJAX request to fetch data from the URL
            $.ajax({
                url: '/admin/get/confirm/booking', // Adjust the URL to match your API endpoint
                method: 'GET',
                dataType: 'json',
                success: function (response) {
                    console.log(response);
                    // Iterate through the data and append it to the table
                    $.each(response.data, function (index, branchs) {
                        // Determine the button content based on the "Status"
                        var button;
                        if (branchs.Booking_status === 1) {
                            button = "<button type='button' class='btn btn-outline-success'>Free</button>";
                        } else if(branchs.Booking_status === 3){
                            button = "<button type='button' class='btn btn-outline-success'>Confirmed</button>";
                        }else {
                            button = "<button type='button' class='btn btn-outline-danger'>reserve</button>";
                        }
                        var action = '<div class="dropdown">' +
                            '<a class="btn btn-link font-24 p-0 line-height-1 no-arrow dropdown-toggle" href="/view/package/' + branchs.ID + '" role="button" data-toggle="dropdown">' +
                            '<i class="dw dw-more"></i>' +
                            '</a>' +
                            '<div class="dropdown-menu dropdown-menu-right dropdown-menu-icon-list">' +
                            '<a class="dropdown-item" href="update/branch?id=' + branchs.ID + '"><i class="dw dw-edit2"></i> Edit</a>' +
                            '<a class="dropdown-item" href="/branchs" onclick="deleteCarousel(' + branchs.ID + ');"><i class="dw dw-delete-3"></i> Delete</a>' +
                            '</div>' +
                            '</div>';
    
                        // Create a new row and append it to the table
                        table.row.add([
                            index + 1, // Sn.
                            branchs.User_name, 
                            branchs.Date,
                            branchs.Total_price,
                            branchs.Total_min_amount_to_pay,
                            branchs.Paid_amount, 
                            branchs.Remaining_amount_to_pay, 
                            button, 
                            
                        ]);
                    });
    
                    // Refresh the table to apply the changes
                    table.draw();
                },
                error: function (error) {
                    console.error('Error fetching data: ' + error);
                }
            });
        });
        
    </script>
    
</body>
</html>
